<% if sections.present? %>
    <div class="mt-3">
        <% sections.each do |section| %>
            <div class="section-item list-group-item list-group-item-action justify-content-between align-items-center bg-light border rounded-3 mb-2 p-2"
                data-room-id="<%= params[:room_id] %>"
                data-time-slot-id="<%= params[:time_slot_id] %>"
                data-section-id="<%= section.id %>">
                <div class="d-flex row w-12">
                    <strong class="mb-1"><%= section.course.course_number %>(<%= section.section_number %>)</strong>
                    <small class="text-muted">Seats: <%= section.seats_alloted %></small>
                </div>
                <div class="badge bg-info-subtle text-dark rounded">Type: <%= section.course.lecture_type %></div>
            </div>
        <% end %>
    </div>
<% else %>
    <p>No courses available for the selected room and time slot.</p>
<% end %>
<script language="javascript" type="text/javascript">
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".section-item").forEach(item => {
      item.addEventListener("click", function() {
        const roomId = this.dataset.roomId;
        const timeSlotId = this.dataset.timeSlotId;
        const sectionId = this.dataset.sectionId;

        fetch("/room_bookings", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-CSRF-Token": "<%= form_authenticity_token %>"
          },
          body: JSON.stringify({ room_id: roomId, time_slot_id: timeSlotId, section_id: sectionId })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            alert(data.message);
          } else {
            alert("Failed to create room booking.");
          }
        });
      });
    });
  });
</script>